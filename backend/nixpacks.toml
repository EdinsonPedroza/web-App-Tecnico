[phases.setup]
nixPkgs = ["python311"]

[phases.install]
cmds = ["pip install -r requirements.txt"]

[phases.build]
cmds = ["mkdir -p uploads"]

[start]
# NOTE: For async FastAPI apps, workers use multiprocessing. Consider setting WORKERS=1
# and relying on async concurrency, or use Gunicorn with uvicorn workers for better process management.
cmd = "uvicorn server:app --host 0.0.0.0 --port $PORT --workers ${WORKERS:-4}"
